import pytest
import csv
import os
import random
from explorer_auto.common.yaml_util import clear_config_yaml
from explorer_auto.action.action_explorer import ActionExplorer


"""
    TODO：前置条件的准备：
        配置graph、hdfs以及palto节点的信息
"""

@pytest.fixture(scope="session", autouse=True)
def clear_config():
    # 登录
    ActionExplorer.action_connect()
    
    # 运行ExplorerAPI的前提条件，创建依赖的workflow，理论上首次运行即可。需要的话也可以每次执行（前提：清空tmp.yaml中的内容），看需求
    # 需要注意的是，如果需要创建Explorer，需要调用的connect接口为：/api-nebula/db/connect
    # 清除tmp文件
    clear_config_yaml()
    workflows = [
        {"name":"不需要参数_单tasks_不输入参数","schema":"{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"analytics_pagerank_1\",\"name\":\"PageRank\",\"clusterSize\":1,\"type\":\"analytics_pagerank\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"true\",\"eps\":\"0.0001\",\"damping\":\"0.85\",\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\",\"vtype\":\"string\",\"processes\":1,\"threads\":3},\"graph\":{\"x\":420,\"y\":262,\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[]}"},
        {"name":"不需要参数_单tasks_输入参数","schema":'{ "datasources": [ { "type": "hdfs", "name": "test", "spec": { "user": "root", "url": "hdfs://192.168.8.168:9000/ll_test" } } ], "tasks": [ { "id": "analytics_pagerank_1", "name": "PageRank", "clusterSize": 1, "type": "analytics_pagerank", "spec": { "iterations": "10", "is_directed": "true", "eps": "0.0001", "damping": "0.85", "processes": 1, "threads": 3 }, "graph": { "x": 270, "y": 210, "groupName": "nodeImportance", "input": [ { "name": "src", "dataType": "string" }, { "name": "dst", "dataType": "string" } ], "output": [ { "name": "vid", "dataType": "string" }, { "name": "value", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "hdfs", "spec": { "type": "dependence" } } } ], "deps": [] }'},
        {"name":"需要1个参数_单tasks_不同类型参数","schema":"{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"analytics_sssp_7\",\"name\":\"SSSP\",\"clusterSize\":1,\"type\":\"analytics_sssp\",\"spec\":{\"root\":\"${root}\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"belong_to,commented_at,created_post,follow,lived_in,serve\",\"nebula_input_edges_props\":\",,,,,\"},\"graph\":{\"x\":935.5,\"y\":216.3000030517578,\"params\":[{\"name\":\"root\"}],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"query_8\",\"name\":\"Query\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"123\",\"vtype\":\"string\"},\"graph\":{\"x\":245.5,\"y\":240.3000030517578,\"params\":[{\"name\":\"True\",\"dataType\":\"string\"},{\"name\":\"\\\"你好，新年快乐\\\"\",\"dataType\":\"string\"},{\"name\":\"\\\"123\\\":\\\"root\\\"\",\"dataType\":\"string\"},{\"name\":\"2022-8-19\",\"dataType\":\"string\"}],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"123\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"Anti-money laundering\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_bfs_9\",\"name\":\"BFS\",\"clusterSize\":1,\"type\":\"analytics_bfs\",\"spec\":{\"is_directed\":\"true\",\"root\":\"${root}\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":705.5,\"y\":246.3000030517578,\"params\":[{\"name\":\"root\"}],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_bnc_11\",\"name\":\"BNC\",\"clusterSize\":1,\"type\":\"analytics_bnc\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"false\",\"chosen\":\"${chosen}\",\"constant\":\"2\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"Assessment passed,Capital dispersion,Capital inflow,First transaction,Risk control testing\",\"nebula_input_edges_props\":\",,,,\"},\"graph\":{\"x\":475.5,\"y\":240.3000030517578,\"params\":[{\"name\":\"chosen\"}],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_jaccard_similarity_12\",\"name\":\"JaccardSimilarity\",\"clusterSize\":1,\"type\":\"analytics_jaccard_similarity\",\"spec\":{\"ids1\":\"${ids1}\",\"ids2\":\"${ids2}\",\"removed_self_edge\":\"true\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":5.5,\"y\":192.3000030517578,\"params\":[{\"name\":\"ids1\"},{\"name\":\"ids2\"}],\"groupName\":\"clustering\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"id1\",\"dataType\":\"string\"},{\"name\":\"id2\",\"dataType\":\"string\"},{\"name\":\"similarity\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[]}"},
        {"name":"需要1个参数_单tasks_不输入参数","schema":'{ "datasources": [ { "type": "hdfs", "name": "test", "spec": { "user": "root", "url": "hdfs://192.168.8.168:9000/ll_test" } } ], "tasks": [ { "id": "analytics_sssp_7", "name": "SSSP", "clusterSize": 1, "type": "analytics_sssp", "spec": { "root": "", "vtype": "string", "processes": 1, "threads": 3, "nebula_input_edges": "belong_to,commented_at,created_post,follow,lived_in,serve", "nebula_input_edges_props": ",,,,," }, "graph": { "x": 1310, "y": 200, "params": [], "groupName": "path", "input": [ { "name": "src", "dataType": "string" }, { "name": "dst", "dataType": "string" }, { "name": "weight", "dataType": "string" } ], "output": [ { "name": "vid", "dataType": "string" }, { "name": "count", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "nebula", "spec": { "type": "nebula", "space": "demo_basketballplayer", "graphd": "192.168.8.131:9669", "user": "root", "graphd_timeout": 60000, "metad_timeout": 60000, "storaged_timeout": 60000 } } }, { "id": "query_8", "name": "Query", "clusterSize": 1, "type": "nebula_ngql", "spec": { "ngql": "", "vtype": "string" }, "graph": { "x": 620, "y": 220, "params": [], "groupName": "query", "input": [], "output": [ { "name": "123", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "nebula", "spec": { "space": "Anti-money laundering", "graphd": "192.168.8.131:9669", "user": "root", "graphd_timeout": 60000, "metad_timeout": 60000, "storaged_timeout": 60000 } } }, { "id": "analytics_bfs_9", "name": "BFS", "clusterSize": 1, "type": "analytics_bfs", "spec": { "is_directed": "true", "root": "", "vtype": "string", "processes": 1, "threads": 3, "nebula_input_edges": "follow,serve", "nebula_input_edges_props": "," }, "graph": { "x": 1076.6640625, "y": 228.79999542236328, "params": [], "groupName": "path", "input": [ { "name": "src", "dataType": "string" }, { "name": "dst", "dataType": "string" } ], "output": [ { "name": "vid", "dataType": "string" }, { "name": "count", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "nebula", "spec": { "type": "nebula", "space": "demo_basketballplayer", "graphd": "192.168.8.131:9669", "user": "root", "graphd_timeout": 60000, "metad_timeout": 60000, "storaged_timeout": 60000 } } }, { "id": "analytics_bnc_11", "name": "BNC", "clusterSize": 1, "type": "analytics_bnc", "spec": { "iterations": "10", "is_directed": "false", "chosen": "", "constant": "", "vtype": "string", "processes": 1, "threads": 3, "nebula_input_edges": "Assessment passed,Capital dispersion,Capital inflow,First transaction,Risk control testing", "nebula_input_edges_props": ",,,," }, "graph": { "x": 846.6640625, "y": 222.79999542236328, "params": [], "groupName": "nodeImportance", "input": [ { "name": "src", "dataType": "string" }, { "name": "dst", "dataType": "string" } ], "output": [ { "name": "vid", "dataType": "string" }, { "name": "value", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "nebula", "spec": { "type": "nebula", "space": "demo_basketballplayer", "graphd": "192.168.8.131:9669", "user": "root", "graphd_timeout": 60000, "metad_timeout": 60000, "storaged_timeout": 60000 } } }, { "id": "analytics_jaccard_similarity_12", "name": "JaccardSimilarity", "clusterSize": 1, "type": "analytics_jaccard_similarity", "spec": { "ids1": "", "ids2": "", "removed_self_edge": "true", "vtype": "string", "processes": 1, "threads": 3, "nebula_input_edges": "follow,serve", "nebula_input_edges_props": "," }, "graph": { "x": 376.6640625, "y": 174.79999542236328, "params": [], "groupName": "clustering", "input": [ { "name": "src", "dataType": "string" }, { "name": "dst", "dataType": "string" } ], "output": [ { "name": "id1", "dataType": "string" }, { "name": "id2", "dataType": "string" }, { "name": "similarity", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "nebula", "spec": { "type": "nebula", "space": "demo_basketballplayer", "graphd": "192.168.8.131:9669", "user": "root", "graphd_timeout": 60000, "metad_timeout": 60000, "storaged_timeout": 60000 } } } ], "deps": [] }'},
        {"name":"需要多个参数_单tasks_不同类型参数","schema":"{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"analytics_jaccard_similarity_12\",\"name\":\"JaccardSimilarity\",\"clusterSize\":1,\"type\":\"analytics_jaccard_similarity\",\"spec\":{\"ids1\":\"1.0000000000000000！@#！@￥\",\"ids2\":\"1！@@@@@@@@1421000\",\"removed_self_edge\":\"true\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":760,\"y\":330,\"params\":[],\"groupName\":\"clustering\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"id1\",\"dataType\":\"string\"},{\"name\":\"id2\",\"dataType\":\"string\"},{\"name\":\"similarity\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"query_13\",\"name\":\"Query\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"return \\\"你好\\\"\",\"vtype\":\"string\"},\"graph\":{\"x\":210,\"y\":320,\"params\":[{\"name\":\"“你好”\",\"dataType\":\"string\"},{\"name\":\"1.0000000000000001\",\"dataType\":\"string\"},{\"name\":\"1000-01-01/9999-12\",\"dataType\":\"string\"},{\"name\":\"True\",\"dataType\":\"string\"},{\"name\":\"@！￥！@#%！#@%@！@#\",\"dataType\":\"string\"}],\"groupName\":\"query\",\"output\":[{\"name\":\"\\\"你好\\\"\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[]}"},
        {"name":"需要多个参数_单tasks_不输入参数","schema":"{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"analytics_jaccard_similarity_12\",\"name\":\"JaccardSimilarity\",\"clusterSize\":1,\"type\":\"analytics_jaccard_similarity\",\"spec\":{\"ids1\":\"\",\"ids2\":\"\",\"removed_self_edge\":\"true\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":1303,\"y\":253,\"params\":[],\"groupName\":\"clustering\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"id1\",\"dataType\":\"string\"},{\"name\":\"id2\",\"dataType\":\"string\"},{\"name\":\"similarity\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"query_13\",\"name\":\"Query\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"return \\\"你好\\\"\",\"vtype\":\"string\"},\"graph\":{\"x\":753,\"y\":243,\"params\":[{\"dataType\":\"string\"},{\"dataType\":\"string\"},{\"dataType\":\"string\"},{\"dataType\":\"string\"},{\"dataType\":\"string\"}],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"\\\"你好\\\"\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[]}"},
        {"name":"创建job_不同组件的参数输入","schema":'{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"query_1\",\"name\":\"Query\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"return \\\"你好\\\"\",\"vtype\":\"string\"},\"graph\":{\"x\":300,\"y\":72,\"params\":[{\"name\":\"\\\"你好\\\"\",\"dataType\":\"string\"}],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"\\\"你好\\\"\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_sssp_2\",\"name\":\"SSSP\",\"clusterSize\":1,\"type\":\"analytics_sssp\",\"spec\":{\"root\":\"player101\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":681,\"y\":66.26666259765625,\"params\":[],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_bfs_3\",\"name\":\"BFS\",\"clusterSize\":1,\"type\":\"analytics_bfs\",\"spec\":{\"is_directed\":\"true\",\"root\":\"player101\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":689,\"y\":461.26666259765625,\"params\":[],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_jaccard_similarity_4\",\"name\":\"JaccardSimilarity\",\"clusterSize\":1,\"type\":\"analytics_jaccard_similarity\",\"spec\":{\"ids1\":\"player101\",\"ids2\":\"player102\",\"removed_self_edge\":\"true\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":301,\"y\":436.26666259765625,\"params\":[],\"groupName\":\"clustering\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"id1\",\"dataType\":\"string\"},{\"name\":\"id2\",\"dataType\":\"string\"},{\"name\":\"similarity\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[]}'},
        {"name":"创建job_输入参数非法格式","schema":'{ "datasources": [ { "type": "hdfs", "name": "test", "spec": { "user": "root", "url": "hdfs://192.168.8.168:9000/ll_test" } } ], "tasks": [ { "id": "analytics_sssp_1", "name": "SSSP", "clusterSize": 1, "type": "analytics_sssp", "spec": { "root": "123456", "processes": 1, "threads": 3 }, "graph": { "x": 440, "y": 93, "params": [], "groupName": "path", "input": [ { "name": "src", "dataType": "string" }, { "name": "dst", "dataType": "string" }, { "name": "weight", "dataType": "string" } ], "output": [ { "name": "vid", "dataType": "string" }, { "name": "count", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "hdfs", "spec": { "type": "dependence" } } }, { "id": "analytics_bfs_2", "name": "BFS", "clusterSize": 1, "type": "analytics_bfs", "spec": { "is_directed": "true", "root": "123", "nebula_input_edges": "follow,serve", "nebula_input_edges_props": ",", "vtype": "string", "processes": 1, "threads": 3 }, "graph": { "x": 170, "y": 140, "groupName": "path", "input": [ { "name": "src", "dataType": "string" }, { "name": "dst", "dataType": "string" } ], "output": [ { "name": "vid", "dataType": "string" }, { "name": "count", "dataType": "string" } ] }, "datasink": { "type": "hdfs", "spec": { "url": "${test}/analytics/${job_id}/tasks/${task_id}/", "hdfsName": "test", "hdfsPath": "/analytics/${job_id}/tasks/${task_id}/", "user": "root" } }, "datasource": { "type": "nebula", "spec": { "type": "nebula", "space": "demo_basketballplayer", "graphd": "192.168.8.131:9669", "user": "root", "graphd_timeout": 60000, "metad_timeout": 60000, "storaged_timeout": 60000 } } } ], "deps": [] }'},
        {"name":"TP-AP-TP","schema":'{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"query_1\",\"name\":\"Query\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"go 1 to 2 steps from \\\"player129\\\" over * yield dst(edge),src(edge)\",\"vtype\":\"string\"},\"graph\":{\"x\":-30,\"y\":70,\"params\":[],\"groupName\":\"query\",\"output\":[{\"name\":\"dst(edge)\",\"dataType\":\"string\"},{\"name\":\"src(edge)\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_apsp_2\",\"name\":\"APSP\",\"clusterSize\":1,\"type\":\"analytics_apsp\",\"spec\":{\"processes\":1,\"threads\":3},\"graph\":{\"x\":230,\"y\":270,\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"hdfs\",\"spec\":{\"type\":\"dependence\"}}},{\"id\":\"query_3\",\"name\":\"Query\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"go 1 to 2 steps from \\\"player129\\\" over * yield ${dst},${src}\",\"vtype\":\"string\"},\"graph\":{\"x\":600,\"y\":140,\"params\":[{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"src\",\"dataType\":\"string\"}],\"groupName\":\"query\",\"output\":[{\"name\":\"${dst}\",\"dataType\":\"string\"},{\"name\":\"${src}\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[{\"src\":\"query_1\",\"dst\":\"analytics_apsp_2\",\"spec\":{\"input\":{\"srcField\":1,\"dstField\":2},\"params\":[]}},{\"src\":\"analytics_apsp_2\",\"dst\":\"query_3\",\"spec\":{\"params\":[{\"name\":\"dst\",\"columnIndex\":1,\"dataType\":\"string\"},{\"name\":\"src\",\"columnIndex\":2,\"dataType\":\"string\"}]}}]}'},
        {"name":"AP-AP-AP","schema":'{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"analytics_apsp_1\",\"name\":\"APSP\",\"clusterSize\":1,\"type\":\"analytics_apsp\",\"spec\":{\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\",\"vtype\":\"string\",\"processes\":1,\"threads\":3},\"graph\":{\"x\":-20,\"y\":340,\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_pagerank_2\",\"name\":\"PageRank\",\"clusterSize\":1,\"type\":\"analytics_pagerank\",\"spec\":{\"processes\":1,\"threads\":3},\"graph\":{\"x\":780,\"y\":300,\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"hdfs\",\"spec\":{\"type\":\"dependence\"}}},{\"id\":\"analytics_apsp_3\",\"name\":\"APSP\",\"clusterSize\":1,\"type\":\"analytics_apsp\",\"spec\":{\"processes\":1,\"threads\":3},\"graph\":{\"x\":430,\"y\":260,\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"hdfs\",\"spec\":{\"type\":\"dependence\"}}}],\"deps\":[{\"src\":\"analytics_apsp_1\",\"dst\":\"analytics_apsp_3\",\"spec\":{\"input\":{\"srcField\":1,\"dstField\":2},\"params\":[]}},{\"src\":\"analytics_apsp_3\",\"dst\":\"analytics_pagerank_2\",\"spec\":{\"input\":{\"srcField\":1,\"dstField\":2},\"params\":[]}}]}'},
        {"name":"所有tasks","schema":'{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"query_1\",\"name\":\"Query\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"match (v) return id(v) limit 10\",\"vtype\":\"string\"},\"graph\":{\"x\":99.5,\"y\":-297.0333251953125,\"params\":[],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"v\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_sssp_2\",\"name\":\"SSSP\",\"clusterSize\":1,\"type\":\"analytics_sssp\",\"spec\":{\"root\":\"player129\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":443,\"y\":-288.2666320800781,\"params\":[],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_apsp_3\",\"name\":\"APSP\",\"clusterSize\":1,\"type\":\"analytics_apsp\",\"spec\":{\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":723,\"y\":-288.2666320800781,\"params\":[],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_bfs_4\",\"name\":\"BFS\",\"clusterSize\":1,\"type\":\"analytics_bfs\",\"spec\":{\"is_directed\":\"true\",\"root\":\"player129\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":99.5,\"y\":-187.0333251953125,\"params\":[],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_pagerank_5\",\"name\":\"PageRank\",\"clusterSize\":1,\"type\":\"analytics_pagerank\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"true\",\"eps\":\"0.0001\",\"damping\":\"0.85\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":99.5,\"y\":2.9666748046875,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_kcore_6\",\"name\":\"KCore\",\"clusterSize\":1,\"type\":\"analytics_kcore\",\"spec\":{\"type\":\"vertex\",\"vertices\":\"0\",\"edges\":\"0\",\"kmin\":\"1\",\"kmax\":\"1000000\",\"iterations\":\"10\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":439.5,\"y\":-87.0333251953125,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_nstepdegrees_7\",\"name\":\"NStepDegrees\",\"clusterSize\":1,\"type\":\"analytics_nstepdegrees\",\"spec\":{\"type\":\"both\",\"step\":\"3\",\"bits\":\"6\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":438.5,\"y\":112.9666748046875,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"degree\",\"dataType\":\"string\"},{\"name\":\"out\",\"dataType\":\"string\"},{\"name\":\"in\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_bnc_8\",\"name\":\"BNC\",\"clusterSize\":1,\"type\":\"analytics_bnc\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"false\",\"chosen\":\"-1\",\"constant\":\"2\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":712.5,\"y\":-40.5333251953125,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_cnc_9\",\"name\":\"CNC\",\"clusterSize\":1,\"type\":\"analytics_cnc\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"false\",\"num_samples\":\"10\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":99.5,\"y\":192.9666748046875,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_degree_with_time_10\",\"name\":\"DegreeWithTime\",\"clusterSize\":1,\"type\":\"analytics_degree_with_time\",\"spec\":{\"type\":\"both\",\"begin_time\":\"2010-10-01 16:59:38\",\"end_time\":\"2022-12-12 16:59:41\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":719.5,\"y\":152.9666748046875,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"degree\",\"dataType\":\"string\"},{\"name\":\"out\",\"dataType\":\"string\"},{\"name\":\"in\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_triangle_count_11\",\"name\":\"TriangleCount\",\"clusterSize\":1,\"type\":\"analytics_triangle_count\",\"spec\":{\"opt\":\"3\",\"removed_duplication_edge\":\"true\",\"removed_self_edge\":\"true\",\"iterations\":\"10\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":960.5,\"y\":-74.5333251953125,\"params\":[],\"groupName\":\"graphFeature\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"id\",\"dataType\":\"string\"},{\"name\":\"id2 | value\",\"dataType\":\"string\"},{\"name\":\"id3\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_node2vec_12\",\"name\":\"Node2Vec\",\"clusterSize\":1,\"type\":\"analytics_node2vec\",\"spec\":{\"is_weighted\":\"false\",\"p\":\"1\",\"q\":\"0.5\",\"epoch\":\"1\",\"step\":\"10\",\"rate\":\"0.02\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":69.5,\"y\":392.9666748046875,\"params\":[],\"groupName\":\"graphFeature\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"path\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_lpa_13\",\"name\":\"LPA\",\"clusterSize\":1,\"type\":\"analytics_lpa\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"true\",\"is_calc_modularity\":\"false\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":429.5,\"y\":372.9666748046875,\"params\":[],\"groupName\":\"communityDiscovery\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"label\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_hanp_14\",\"name\":\"HANP\",\"clusterSize\":1,\"type\":\"analytics_hanp\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"true\",\"preference\":\"1\",\"hop_att\":\"0.1\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":29.5,\"y\":602.9666748046875,\"params\":[],\"groupName\":\"communityDiscovery\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"label\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_wcc_15\",\"name\":\"WCC\",\"clusterSize\":1,\"type\":\"analytics_wcc\",\"spec\":{\"is_directed\":\"false\",\"is_calc_modularity\":\"false\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":719.5,\"y\":442.9666748046875,\"params\":[],\"groupName\":\"communityDiscovery\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"label\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_louvain_16\",\"name\":\"Louvain\",\"clusterSize\":1,\"type\":\"analytics_louvain\",\"spec\":{\"is_directed\":\"false\",\"outer_iteration\":\"3\",\"inner_iteration\":\"2\",\"is_calc_modularity\":\"false\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":789.5,\"y\":642.9666748046875,\"params\":[],\"groupName\":\"communityDiscovery\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"label\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_clustering_coefficient_17\",\"name\":\"ClusteringCoefficient\",\"clusterSize\":1,\"type\":\"analytics_clustering_coefficient\",\"spec\":{\"type\":\"local\",\"removed_duplication_edge\":\"true\",\"removed_self_edge\":\"true\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":409.5,\"y\":582.9666748046875,\"params\":[],\"groupName\":\"clustering\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_jaccard_similarity_18\",\"name\":\"JaccardSimilarity\",\"clusterSize\":1,\"type\":\"analytics_jaccard_similarity\",\"spec\":{\"ids1\":\"player101\",\"ids2\":\"player102\",\"removed_self_edge\":\"true\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":409.5,\"y\":802.9666748046875,\"params\":[],\"groupName\":\"clustering\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"id1\",\"dataType\":\"string\"},{\"name\":\"id2\",\"dataType\":\"string\"},{\"name\":\"similarity\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[]}'},
        {"name":"workflow_列数","schema":'{\"datasources\":[{\"type\":\"hdfs\",\"name\":\"test\",\"spec\":{\"user\":\"root\",\"url\":\"hdfs://192.168.8.168:9000/ll_test\"}}],\"tasks\":[{\"id\":\"query_5\",\"name\":\"Query-输出结果为空\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"match (v) where id(v)==\\\"121212\\\" return id(v)\",\"vtype\":\"string\"},\"graph\":{\"x\":360,\"y\":-107.52914428710938,\"params\":[],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"id(v)\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"query_6\",\"name\":\"Query-输出1列\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"match (v) return id(v) limit 10\",\"vtype\":\"string\"},\"graph\":{\"x\":534.25,\"y\":85.96253967285156,\"params\":[],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"v\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"query_7\",\"name\":\"Query-输出2列\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"match ()-[e]->() return src(e),dst(e) limit 10\",\"vtype\":\"string\"},\"graph\":{\"x\":554.25,\"y\":280.96253967285156,\"params\":[],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"src(e)\",\"dataType\":\"string\"},{\"name\":\"limit(e)\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"query_8\",\"name\":\"Query-输出队列，不同格式\",\"clusterSize\":1,\"type\":\"nebula_ngql\",\"spec\":{\"ngql\":\"return date(),datetime(),\\\"你好好你好加油加油~~~~\\\",rand(),rand32(),3-300;\",\"vtype\":\"string\"},\"graph\":{\"x\":567.25,\"y\":496.96253967285156,\"params\":[],\"groupName\":\"query\",\"input\":[],\"output\":[{\"name\":\"date()\",\"dataType\":\"string\"},{\"name\":\"datetime()\",\"dataType\":\"string\"},{\"name\":\"\\\"你好好你好加油加油~~~~\\\"\",\"dataType\":\"string\"},{\"name\":\"rand()\",\"dataType\":\"string\"},{\"name\":\"rand32()\",\"dataType\":\"string\"},{\"name\":\"3-300\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_pagerank_9\",\"name\":\"PageRank-2列\",\"clusterSize\":1,\"type\":\"analytics_pagerank\",\"spec\":{\"iterations\":\"10\",\"is_directed\":\"true\",\"eps\":\"0.0001\",\"damping\":\"0.85\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":1030.5,\"y\":164.46253967285156,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"value\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_degree_with_time_10\",\"name\":\"DegreeWithTime-四列\",\"clusterSize\":1,\"type\":\"analytics_degree_with_time\",\"spec\":{\"type\":\"both\",\"begin_time\":\"\",\"end_time\":\"\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":950.5,\"y\":474.46253967285156,\"params\":[],\"groupName\":\"nodeImportance\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"vid\",\"dataType\":\"string\"},{\"name\":\"degree\",\"dataType\":\"string\"},{\"name\":\"out\",\"dataType\":\"string\"},{\"name\":\"in\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_triangle_count_11\",\"name\":\"TriangleCount-1列\",\"clusterSize\":1,\"type\":\"analytics_triangle_count\",\"spec\":{\"opt\":\"1\",\"removed_duplication_edge\":\"true\",\"removed_self_edge\":\"true\",\"iterations\":\"10\",\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":-40.5,\"y\":623.4625396728516,\"params\":[],\"groupName\":\"graphFeature\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"id\",\"dataType\":\"string\"},{\"name\":\"id2 | value\",\"dataType\":\"string\"},{\"name\":\"id3\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}},{\"id\":\"analytics_apsp_12\",\"name\":\"APSP\",\"clusterSize\":1,\"type\":\"analytics_apsp\",\"spec\":{\"vtype\":\"string\",\"processes\":1,\"threads\":3,\"nebula_input_edges\":\"follow,serve\",\"nebula_input_edges_props\":\",\"},\"graph\":{\"x\":970,\"y\":-117.52914428710938,\"params\":[],\"groupName\":\"path\",\"input\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"weight\",\"dataType\":\"string\"}],\"output\":[{\"name\":\"src\",\"dataType\":\"string\"},{\"name\":\"dst\",\"dataType\":\"string\"},{\"name\":\"count\",\"dataType\":\"string\"}]},\"datasink\":{\"type\":\"hdfs\",\"spec\":{\"url\":\"${test}/analytics/${job_id}/tasks/${task_id}/\",\"hdfsName\":\"test\",\"hdfsPath\":\"/analytics/${job_id}/tasks/${task_id}/\",\"user\":\"root\"}},\"datasource\":{\"type\":\"nebula\",\"spec\":{\"type\":\"nebula\",\"space\":\"demo_basketballplayer\",\"graphd\":\"192.168.8.131:9669\",\"user\":\"root\",\"graphd_timeout\":60000,\"metad_timeout\":60000,\"storaged_timeout\":60000}}}],\"deps\":[]}'}        
        ]
    for a in workflows:
        ActionExplorer.action_ceate_workflow(a["name"],a["schema"])
        

    # 要判断的目录路径
    dir_path = "explorer_auto/csv"
    # 获取目录下的所有文件
    files = os.listdir(dir_path)

    # 判断是否存在 csv 文件
    if any(file.endswith('.csv') for file in files):
        # 如果存在 csv 文件，打印提示信息
        print("目录下存在 csv 文件，不执行相应的代码")
    else:
        # 要写入的文件名
        filenames = [
            r'explorer_auto/csv/1mb_player.csv',
            r'explorer_auto/csv/1列_player.csv',
            r'explorer_auto/csv/1行数据_player.csv',
            r'explorer_auto/csv/10mb_player.csv',
            r'explorer_auto/csv/10列_player.csv',
            r'explorer_auto/csv/10行数据_player.csv',
            r'explorer_auto/csv/50mb_player.csv',
            r'explorer_auto/csv/50列_player.csv',
            r'explorer_auto/csv/100mb_player.csv',
            r'explorer_auto/csv/上传多个文件1_player.csv',
            r'explorer_auto/csv/上传多个文件2_player.csv',
            r'explorer_auto/csv/上传多个文件3_player.csv',
            r'explorer_auto/csv/特殊字符_中英文_长度_2%$%$^player.csv',
            r'explorer_auto/csv/非csv文件'
        ]
        absolute_paths = [os.path.abspath(filename) for filename in filenames]
        # 随机数据的行数
        num_rows = [55000,550,1,550000,550,10,2750000,550,5500000,5500000,5500000,5500000,55000,1]
        # 随机数据的列数
        num_cols = [3,1,3,3,10,3,3,50,3,3,3,3,3,3]
        # 使用 with 语句打开文件，并创建一个 CSV 写入器
        for i in range(len(filenames)):
            filename = filenames[i]
            with open(filename, 'w', newline='') as csvfile:
                writer = csv.writer(csvfile)
                for j in range(num_rows[i]):
                    row = [('player' + str(random.randint(1, 10000000)))] + [random.randint(1, 100) for _ in range(num_cols[i] - 1)]
                    writer.writerow(row)

